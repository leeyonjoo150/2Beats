{% extends 'music_explore/base.html' %}

{% block title %}ì°¨íŠ¸ - TwoBeats{% endblock %}

{% block extra_css %}
<style>
    /* íƒ­ ìŠ¤íƒ€ì¼ */
    .tabs {
        display: flex;
        gap: 0;
        border-bottom: 2px solid #eee;
        margin-bottom: 2rem;
    }
    
    .tab {
        padding: 1rem 2rem;
        background: none;
        border: none;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 500;
        color: #666;
        transition: all 0.3s;
        border-bottom: 3px solid transparent;
    }
    
    .tab:hover {
        color: #1db954;
    }
    
    .tab.active {
        color: #1db954;
        border-bottom-color: #1db954;
    }
    
    .tab-content {
        display: none;
    }
    
    .tab-content.active {
        display: block;
    }
</style>
{% endblock %}

{% block content %}
<div class="card">
    <h1 style="margin-bottom: 1.5rem;">ğŸ“Š ìŒì•… ì°¨íŠ¸</h1>
    
    <!-- íƒ­ ë²„íŠ¼ -->
    <div class="tabs">
        <button id="popular-btn" class="tab active" onclick="showTab('popular', this)">ì¸ê¸° ì°¨íŠ¸</button>
        <button id="latest-btn" class="tab" onclick="showTab('latest', this)">ìµœì‹  ì°¨íŠ¸</button>
        <button id="liked-btn" class="tab" onclick="showTab('liked', this)">ì¢‹ì•„ìš” ì°¨íŠ¸</button>
    </div>
</div>

<!-- ì¸ê¸° ì°¨íŠ¸ -->
<div id="popular-tab" class="tab-content active">
    <div class="card">
        <h2 style="margin-bottom: 1rem; color: #1db954;">ğŸ”¥ ì¸ê¸° ì°¨íŠ¸ (ì¬ìƒìˆ˜ìˆœ)</h2>
        {% if popular_musics %}
            <div style="display: grid; gap: 1rem;">
                {% for music in popular_musics %}
                    <div style="
                        padding: 1rem; 
                        border: 1px solid #eee; 
                        border-radius: 8px;
                        display: flex;
                        gap: 1rem;
                        align-items: center;
                        transition: all 0.3s;
                    " onmouseover="this.style.backgroundColor='#f9f9f9'" 
                       onmouseout="this.style.backgroundColor='white'">
                        
                        <!-- ìˆœìœ„ -->
                        <div style="
                            font-size: 2rem; 
                            font-weight: bold; 
                            color: #1db954;
                            min-width: 50px;
                            text-align: center;
                        ">
                            {{ forloop.counter }}
                        </div>
                        
                        <!-- ì¸ë„¤ì¼ -->
                        <div style="min-width: 80px; max-width: 80px;">
                            {% if music.music_thumbnail %}
                                <img src="{{ music.music_thumbnail.url }}" 
                                     alt="{{ music.music_title }}"
                                     style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">
                            {% else %}
                                <div style="
                                    width: 80px; height: 80px; 
                                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                                    border-radius: 8px;
                                    display: flex; align-items: center; justify-content: center;
                                    font-size: 2rem;
                                ">ğŸµ</div>
                            {% endif %}
                        </div>
                        
                        <!-- ì •ë³´ -->
                        <div style="flex: 1;">
                            <h3 style="margin-bottom: 0.5rem;">
                                <a href="{% url 'music_explore:detail' music.id %}" 
                                   style="color: #333; text-decoration: none;">
                                    {{ music.music_title }}
                                </a>
                            </h3>
                            <p style="color: #666; margin-bottom: 0.3rem;">{{ music.music_singer }}</p>
                            <p style="color: #999; font-size: 0.9rem;">
                                {{ music.get_music_type_display }} | 
                                ì¬ìƒ {{ music.music_count }}íšŒ | 
                                ì¢‹ì•„ìš” {{ music.music_like_count }}
                                {% if music.tags.all %}
                                    | {% for tag in music.tags.all %}
                                        <span style="color: #1db954;">#{{ tag.name }}</span>{% if not forloop.last %}, {% endif %}
                                    {% endfor %}
                                {% endif %}
                            </p>
                        </div>
                        
                        <!-- ì¬ìƒ ë²„íŠ¼ -->
                        <a href="{% url 'music_explore:detail' music.id %}" class="btn btn-primary">ì¬ìƒ â–¶</a>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p style="text-align: center; color: #999; padding: 2rem;">ì°¨íŠ¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endif %}
    </div>
</div>

<!-- ìµœì‹  ì°¨íŠ¸ -->
<div id="latest-tab" class="tab-content">
    <div class="card">
        <h2 style="margin-bottom: 1rem; color: #1db954;">ğŸ†• ìµœì‹  ì°¨íŠ¸ (ì—…ë¡œë“œìˆœ)</h2>
        {% if latest_musics %}
            <div style="display: grid; gap: 1rem;">
                {% for music in latest_musics %}
                    <div style="
                        padding: 1rem; 
                        border: 1px solid #eee; 
                        border-radius: 8px;
                        display: flex;
                        gap: 1rem;
                        align-items: center;
                        transition: all 0.3s;
                    " onmouseover="this.style.backgroundColor='#f9f9f9'" 
                       onmouseout="this.style.backgroundColor='white'">
                        
                        <div style="font-size: 2rem; font-weight: bold; color: #1db954; min-width: 50px; text-align: center;">
                            {{ forloop.counter }}
                        </div>
                        
                        <div style="min-width: 80px; max-width: 80px;">
                            {% if music.music_thumbnail %}
                                <img src="{{ music.music_thumbnail.url }}" 
                                     alt="{{ music.music_title }}"
                                     style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">
                            {% else %}
                                <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 2rem;">ğŸµ</div>
                            {% endif %}
                        </div>
                        
                        <div style="flex: 1;">
                            <h3 style="margin-bottom: 0.5rem;">
                                <a href="{% url 'music_explore:detail' music.id %}" style="color: #333; text-decoration: none;">
                                    {{ music.music_title }}
                                </a>
                            </h3>
                            <p style="color: #666; margin-bottom: 0.3rem;">{{ music.music_singer }}</p>
                            <p style="color: #999; font-size: 0.9rem;">
                                {{ music.get_music_type_display }} | 
                                ì¬ìƒ {{ music.music_count }}íšŒ | 
                                ì¢‹ì•„ìš” {{ music.music_like_count }}
                                {% if music.tags.all %}
                                    | {% for tag in music.tags.all %}
                                        <span style="color: #1db954;">#{{ tag.name }}</span>{% if not forloop.last %}, {% endif %}
                                    {% endfor %}
                                {% endif %}
                            </p>
                        </div>
                        
                        <a href="{% url 'music_explore:detail' music.id %}" class="btn btn-primary">ì¬ìƒ â–¶</a>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p style="text-align: center; color: #999; padding: 2rem;">ì°¨íŠ¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endif %}
    </div>
</div>

<!-- ì¢‹ì•„ìš” ì°¨íŠ¸ -->
<div id="liked-tab" class="tab-content">
    <div class="card">
        <h2 style="margin-bottom: 1rem; color: #1db954;">â¤ï¸ ì¢‹ì•„ìš” ì°¨íŠ¸ (ì¢‹ì•„ìš”ìˆœ)</h2>
        {% if liked_musics %}
            <div style="display: grid; gap: 1rem;">
                {% for music in liked_musics %}
                    <div style="
                        padding: 1rem; 
                        border: 1px solid #eee; 
                        border-radius: 8px;
                        display: flex;
                        gap: 1rem;
                        align-items: center;
                        transition: all 0.3s;
                    " onmouseover="this.style.backgroundColor='#f9f9f9'" 
                       onmouseout="this.style.backgroundColor='white'">
                        
                        <div style="font-size: 2rem; font-weight: bold; color: #1db954; min-width: 50px; text-align: center;">
                            {{ forloop.counter }}
                        </div>
                        
                        <div style="min-width: 80px; max-width: 80px;">
                            {% if music.music_thumbnail %}
                                <img src="{{ music.music_thumbnail.url }}" 
                                     alt="{{ music.music_title }}"
                                     style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">
                            {% else %}
                                <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 2rem;">ğŸµ</div>
                            {% endif %}
                        </div>
                        
                        <div style="flex: 1;">
                            <h3 style="margin-bottom: 0.5rem;">
                                <a href="{% url 'music_explore:detail' music.id %}" style="color: #333; text-decoration: none;">
                                    {{ music.music_title }}
                                </a>
                            </h3>
                            <p style="color: #666; margin-bottom: 0.3rem;">{{ music.music_singer }}</p>
                            <p style="color: #999; font-size: 0.9rem;">
                                {{ music.get_music_type_display }} | 
                                ì¬ìƒ {{ music.music_count }}íšŒ | 
                                ì¢‹ì•„ìš” {{ music.music_like_count }}
                                {% if music.tags.all %}
                                    | {% for tag in music.tags.all %}
                                        <span style="color: #1db954;">#{{ tag.name }}</span>{% if not forloop.last %}, {% endif %}
                                    {% endfor %}
                                {% endif %}
                            </p>
                        </div>
                        
                        <a href="{% url 'music_explore:detail' music.id %}" class="btn btn-primary">ì¬ìƒ â–¶</a>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p style="text-align: center; color: #999; padding: 2rem;">ì°¨íŠ¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endif %}
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
function showTab(tabName, element) {
    // ëª¨ë“  íƒ­ ë²„íŠ¼ ë¹„í™œì„±í™”
    document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // ëª¨ë“  íƒ­ ì½˜í…ì¸  ìˆ¨ê¸°ê¸°
    document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
    });
    
    // í´ë¦­í•œ íƒ­ ë²„íŠ¼ í™œì„±í™”
    element.classList.add('active');
    
    // ì„ íƒí•œ íƒ­ ì½˜í…ì¸  í‘œì‹œ
    document.getElementById(tabName + '-tab').classList.add('active');
}
</script>
{% endblock %}